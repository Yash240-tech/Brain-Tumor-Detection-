<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NeuroScan Report</title>
    <link rel="stylesheet" href="style_report.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Style only for the PDF button (won't affect other elements) */
        .pdf-button {
            display: block;
            margin: 30px auto;
            padding: 12px 24px;
            background-color: #4a6bff;
            color: white;
            border: none;
            border-radius: 6px;
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(74, 107, 255, 0.3);
        }
        .pdf-button:hover {
            background-color: #3a56d4;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(74, 107, 255, 0.4);
        }
        .pdf-button:active {
            transform: translateY(0);
        }
        
        /* This class will be used to hide elements in PDF */
        .no-print {
            display: block;
        }
        @media print {
            .no-print {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <div class="report-header">
        <div class="logo">Neuro<span>Scan</span></div>
        <h1 class="report-title">Diagnostic Report</h1>
        <p class="report-subtitle">Brain Tumor Detection Analysis</p>
        <p class="report-date" id="report-date">Report Date: </p>
    </div>
    
    <div class="section">
        <h2 class="section-title">Patient Information</h2>
        <div class="patient-info">
            <div class="info-item">
                <span class="info-label">Patient ID:</span>
                <span id="report-id"></span>
            </div>
            <div class="info-item">
                <span class="info-label">Patient Name:</span>
                <span id="report-name"></span>
            </div>
            <div class="info-item">
                <span class="info-label">Phone Number:</span>
                <span id="report-phn"></span>
            </div>
            <div class="info-item">
                <span class="info-label">Age:</span>
                <span id="report-age"></span>
            </div>
            <div class="info-item">
                <span class="info-label">Blood Type:</span>
                <span id="report-blood"></span>
            </div>
        </div>
    </div>
    
    <div class="section">
        <h2 class="section-title">Diagnostic Results</h2>
        <div class="result-container">
            <div id="report-result" class="result-negative">
                Tumor Detection: 
            </div>
            <div class="confidence" id="report-confidence">
                Confidence Level: 
            </div>
        </div>
    </div>
    
    <div class="section">
        <h2 class="section-title">Notes</h2>
        <p>This report is generated by NeuroScan AI Diagnostics System. The results are based on analysis of the provided MRI scan and should be reviewed by a qualified medical professional.</p>
        <p>For any questions or concerns about this report, please contact our support team.</p>
    </div>

    <div class="no-print" style="text-align: center;">
        <button onclick="generatePDF()" class="pdf-button">Download PDF Report</button>
    </div>
    
    <div class="footer">
        <p>&copy; <span id="report-year"></span> NeuroScan AI Diagnostics. All rights reserved.</p>
        <p>This is an automated report. No signature is required.</p>
    </div>

    <script>
        // Get parameters from URL
        const urlParams = new URLSearchParams(window.location.search);
        
        // Set patient information
        document.getElementById('report-id').textContent = urlParams.get('id') || 'Not provided';
        document.getElementById('report-name').textContent = urlParams.get('name') || 'Not provided';
        document.getElementById('report-phn').textContent = urlParams.get('phn') || 'Not provided';
        document.getElementById('report-age').textContent = urlParams.get('age') || 'Not provided';
        document.getElementById('report-blood').textContent = urlParams.get('bloodType') || 'Not provided';
        
        // Set results
        const result = urlParams.get('result');
        const confidence = urlParams.get('confidence');
        const resultElement = document.getElementById('report-result');
        
        if (result) {
            resultElement.textContent = 'Tumor Detection: ' + result;
            if (result.includes('+ve')) {
                resultElement.className = 'result-positive';
            } else {
                resultElement.className = 'result-negative';
            }
        }
        
        if (confidence) {
            document.getElementById('report-confidence').textContent = 'Confidence Level: ' + confidence;
        }
        
        // Set dates and year
        document.getElementById('report-date').textContent += new Date().toLocaleDateString();
        document.getElementById('report-year').textContent = new Date().getFullYear();

        // PDF Generation Functionality
        function generatePDF() {
            // Hide the button before generating PDF
            const button = document.querySelector('.no-print');
            button.style.display = 'none';
            
            // Get the element you want to convert to PDF
            const element = document.body;
            const opt = {
                margin: 10,
                filename: 'NeuroScan_Report.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
            };

            // Generate the PDF
            html2pdf().set(opt).from(element).save().then(() => {
                // Show the button again after PDF generation is complete
                button.style.display = 'block';
            });
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</body>
</html>
